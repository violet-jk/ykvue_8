import{d as b,r as c,p as _,t as x,v as I,c as R,o as V,R as o,J as a,al as t,W as C,u as N,O as P,a as m,az as S}from"./vue-kqFMiSVm.js";import{l as T,E as p}from"./element-plus-CcUPQmts.js";import{_ as z}from"./index-Cl_tPIte.js";const A={class:"login-container"},B=b({__name:"Login",setup(E){const y=S(),l=c(),r=c(!1),i=c(),n=_({apiKey:""}),g=_({apiKey:[{required:!0,message:"请输入API密钥",trigger:"blur"}]}),u=async()=>{l.value&&await l.value.validate(async d=>{if(d){r.value=!0;try{const e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:n.apiKey})}),s=await e.json();e.ok&&s.success?(localStorage.setItem("auth_token",s.token),p.success("登录成功！"),y.push("/")):p.error(s.message||"API密钥错误")}catch(e){console.error("登录失败:",e),p.error("登录失败，请检查网络连接")}finally{r.value=!1}}})};return x(()=>{I(()=>{i.value&&i.value.focus()})}),(d,e)=>{const s=t("el-icon"),v=t("el-input"),f=t("el-form-item"),h=t("el-button"),k=t("el-form"),w=t("el-card");return V(),R("div",A,[o(w,{class:"login-card"},{header:a(()=>[...e[1]||(e[1]=[m("div",{class:"card-header"},[m("span",null,"系统登录")],-1)])]),default:a(()=>[o(k,{model:n,rules:g,ref_key:"loginFormRef",ref:l,"label-width":"0",onSubmit:C(u,["prevent"])},{default:a(()=>[o(f,{prop:"apiKey"},{default:a(()=>[o(v,{modelValue:n.apiKey,"onUpdate:modelValue":e[0]||(e[0]=K=>n.apiKey=K),type:"password",placeholder:"请输入API密钥","show-password":"",size:"large",clearable:"",ref_key:"apiKeyInputRef",ref:i},{prefix:a(()=>[o(s,null,{default:a(()=>[o(N(T))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,null,{default:a(()=>[o(h,{type:"primary",style:{width:"100%"},size:"large",loading:r.value,onClick:u},{default:a(()=>[...e[2]||(e[2]=[P(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}}),O=z(B,[["__scopeId","data-v-0251952a"]]);export{O as default};
